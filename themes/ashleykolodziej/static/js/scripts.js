function runPackery(){var a=$("#gallery").masonry({itemSelector:".gallery-item"});a.imagesLoaded().progress(function(){a.masonry("layout")})}function slidesPrev(a){var b=$(".current"),c=b.prev();b.removeClass("current"),c.addClass("current"),c.is(":first-child")?($("#slides-prev").hide(),$document.unbind("keydown",keyboardSlideControls.prev),$document.bind("keydown",keyboardSlideControls.next)):($("#slides-prev").show(),$("#slides-next").show())}function slidesNext(a){var b=$(".current"),c=b.next();b.removeClass("current"),c.addClass("current"),c.is(":last-child")?($("#slides-next").hide(),$document.unbind("keydown",keyboardSlideControls.next),$document.bind("keydown",keyboardSlideControls.prev)):($("#slides-prev").show(),$("#slides-next").show())}function slidesClose(a){a.preventDefault(),$document.unbind("keydown",keyboardSlideControls.close),$document.unbind("keydown",keyboardSlideControls.prev),$document.unbind("keydown",keyboardSlideControls.next),$("#overlay").removeClass("animateIn"),$("body").removeClass("overlay-visible"),window.setTimeout(function(){$(".gallery-img").removeClass("current"),$("#overlay").remove()},500),$document.scrollTop($scrollTop)}var $scrollTop,$document=$(document),keyboardSlideControls={prev:function(a){37==a.keyCode&&(slidesPrev(),a.preventDefault())},next:function(a){39==a.keyCode&&(slidesNext(),a.preventDefault())},close:function(a){27==a.keyCode&&slidesClose(a)}};$document.ready(function(){function e(a){$.get(a,function(b){b=$(b).find("#content").html(),history.pushState(b,null,a),$("#content").html(history.state),f($("#content"))})}function f(a){$(window).width()<768&&$("#menu").click(),$(window).scrollTop(0),a.children().addClass("loadin"),b.addClass("loadin"),runPackery()}var a=document.body,b=$("#footer");$("html").addClass("has-js");var c=$(".main-navigation-wrap li"),d=$("#all-tags a"),a=$("body");c.addClass("nav-show"),a.on("click",".load-link",function(a){return b.removeClass("loadin"),$(".active").removeClass("active"),$(this).parent().addClass("active"),e(this.href),!1}),window.addEventListener("popstate",function(a){$("#content").html(history.state),f($("#content"))});var g='<div id="overlay"><i id="slides-close" class="material-icons">close</i>';g+='<i id="slides-prev" class="material-icons">chevron_left</i><i id="slides-next" class="material-icons">chevron_right</i>',g+='<div class="slide-container">';var h="</div></div>";if(a.on("click",".gallery-item",function(b){b.preventDefault(),$document.bind("keydown",keyboardSlideControls.close),$document.bind("keydown",keyboardSlideControls.prev),$document.bind("keydown",keyboardSlideControls.next),$(this).children("img").addClass("current"),$img=$(".gallery-img");var c="";$tallimg=$img.first(),tallheight=$tallimg.height(),$img.each(function(){$(this).height()>tallheight&&($tallimg.removeClass("tallest"),$tallimg=$(this),tallheight=$tallimg.height(),$tallimg.addClass("tallest")),c+=$(this)[0].outerHTML}),$("#content-container").append(g+c+h),$thisItem=$("#overlay").find(".current"),$thisItem.is(":first-child")&&($("#slides-prev").hide(),$document.unbind("keydown",keyboardSlideControls.prev)),$thisItem.is(":last-child")&&($("#slides-next").hide(),$document.unbind("keydown",keyboardSlideControls.next)),$scrollTop=a.scrollTop(),a.css("top",-$scrollTop+"px").addClass("overlay-visible"),window.setTimeout(function(){$("#overlay").addClass("animateIn")},10)}),a.on("click","#slides-prev",slidesPrev),a.on("click","#slides-next",slidesNext),a.on("click","#slides-close",slidesClose),$("#all-tags").on("click","a",function(a){a.preventDefault();var b=$(this),e=b.data("cat-filter"),f=$("#filter").children(".material-icons");d.removeClass("filter-active"),b.addClass("filter-active"),"all"===e?(c.addClass("nav-show"),f.removeClass("filter-active"),$(".has-filtered").removeClass("has-filtered"),$(".main-navigation-wrap").removeClass("filter-on")):(f.addClass("filter-active"),c.removeClass("nav-show"),$(".has-filtered").removeClass("has-filtered"),c.filter('[data-category="'+e+'"]').addClass("nav-show").parent("ul").addClass("has-filtered").prev("h3").addClass("has-filtered"),$(".main-navigation-wrap").addClass("filter-on"))}),$("#filter").click(function(a){a.preventDefault();var b=$(this),c=b.children(".material-icons");b.toggleClass("open"),b.next("ul").toggleClass("open"),"clear"==c.html()?c.html("sort"):c.html("clear")}),$("#menu").click(function(){var a=$(this);"close"==a.html()?a.html("menu"):a.html("close"),a.toggleClass("open"),$(".main-navigation, .content-container, body").toggleClass("open")}),runPackery(),$("#content").children().addClass("loadin"),b.addClass("loadin"),"/"!==location.pathname){var i=$("a[href*='"+location.pathname+"']").parent("li");i.addClass("active"),i.offset()&&$(".main-navigation-wrap").scrollTop(i.offset().top-100)}});